% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_creation.R
\name{svy_rake}
\alias{svy_rake}
\title{Calibrate Weights to Population Targets (Raking)}
\usage{
svy_rake(df, targets, base_weight = 1, print_output = TRUE, ...)
}
\arguments{
\item{df}{A data frame or tibble containing the survey variables.}

\item{targets}{A named list of tibbles containing the population targets. The names
of the list elements must match the variable names in \code{df}. The calibration
relies only on the \code{Freq} column (percentages 0-100) in each target tibble.}

\item{base_weight}{A character string for the column in \code{df} containing the
initial weights, or a numeric constant (e.g., \code{1}) for unweighted data.
Defaults to \code{1}.}

\item{print_output}{A logical flag. If \code{TRUE}, the diagnostic report from
\code{svy_diagnostics()} is printed to the console using the full tibble print
(\code{n = Inf}). Defaults to \code{TRUE}.}

\item{...}{Additional arguments passed directly to \code{pewmethods::rake_survey}.}
}
\value{
A \strong{numeric vector} containing the final calibrated weights (named \code{RAKE_WEIGHT}).
}
\description{
Adjusts survey weights to match population margins (targets) using
the underlying Generalized Regression Estimator (GREG) provided by
\code{pewmethods::rake_survey()}.
}
\details{
This function relies on the \code{pewmethods} package for the core raking calculation,
ensuring stability and statistical correctness.

The function passes the \code{base\_weight} directly to \code{pewmethods::rake_survey},
which handles a numeric default of \code{1} or a character string column name.
}
\examples{
# Requires devtools::load_all() and the pewmethods package installed
if (requireNamespace("pewmethods", quietly = TRUE) &&
    requireNamespace("dplyr", quietly = TRUE)) {

  # Load the internal data
  data("survey_df")
  data("target_list")

  # 1. Rake an UNWEIGHTED sample (using base_weight = 1 default)
  raked_weights_1 <- svy_rake(survey_df, target_list)

  # 2. Rake a PRE-WEIGHTED sample
  raked_weights_2 <- svy_rake(survey_df, target_list, base_weight = "WEIGHT")

  # Check the length of the returned vector
  # length(raked_weights_1)
}

}
