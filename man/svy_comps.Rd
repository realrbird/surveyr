% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_diagnostics.R
\name{svy_comps}
\alias{svy_comps}
\title{Compare Survey Frequencies to Population Targets}
\usage{
svy_comps(data, targets, wt_var = NULL)
}
\arguments{
\item{data}{A data frame or tibble containing the survey variables.}

\item{targets}{A named list of tibbles, where each tibble represents the population
targets for a variable. List names must match variable names in \code{data}.}

\item{wt_var}{A \strong{character string} (unquoted column name) in \code{data}
containing the survey weights. If \code{NULL} (the default), the comparison
uses unweighted sample frequencies.}
}
\value{
A single \code{tibble} that aggregates the comparison results for all
variables in \code{targets}.
\itemize{
\item If \code{wt_var} is \code{NULL}, returns 5 columns: \code{VAR}, \code{LEVEL},
\code{TARGET_PERCENT}, \code{UNWT_SAMPLE_PERCENT}, and \code{TARGET_UNWT_DIFF}.
\item If \code{wt_var} is provided, returns 7 columns, adding
\code{WT_SAMPLE_PERCENT} and \code{TARGET_WT_DIFF} to the unweighted comparison results.
}
}
\description{
Calculates the difference between survey frequencies (weighted or
unweighted) and corresponding population target percentages for multiple
demographic variables.
}
\details{
The resulting tibble is structured such that each row represents a category
(e.g., '18-30', 'male', 'South').
\describe{
\item{TARGET\_PERCENT}{The target percentage from the \code{targets} list.}
\item{UNWT\_SAMPLE\_PERCENT}{The calculated sample percentage using unweighted counts.}
\item{WT\_SAMPLE\_PERCENT}{The calculated sample percentage using the provided survey weights (only present if \code{wt_var} is not \code{NULL}).}
\item{TARGET\_UNWT\_DIFF}{The difference between target and unweighted sample frequencies.}
\item{TARGET\_WT\_DIFF}{The difference between target and weighted sample frequencies (only present if \code{wt_var} is not \code{NULL}).}
}

The function relies on the \code{targets} list being correctly structured (validated
by internal checks in \code{chk_target_structure}).
}
\examples{
# Load the package data (requires devtools::load_all() during development)
if (requireNamespace("tibble", quietly = TRUE) && requireNamespace("dplyr", quietly = TRUE)) {
  data("survey_df")
  data("target_list")

  # Weighted comparison (includes unweighted and weighted results)
  svy_comps(survey_df, target_list, wt_var = "WEIGHT")

  # Unweighted comparison (unweighted results only)
  svy_comps(survey_df, target_list)
}

}
