% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_creation.R
\name{svy_trim}
\alias{svy_trim}
\title{Trim Extreme Survey Weights}
\usage{
svy_trim(
  df,
  wt_var,
  lower_quantile = 0.01,
  upper_quantile = 0.99,
  print_output = TRUE,
  ...
)
}
\arguments{
\item{df}{A data frame or tibble containing the survey variables and the weight column.}

\item{wt_var}{A character string for the column in \code{df} containing the weights to be trimmed.}

\item{lower_quantile}{The lower quantile (e.g., 0.01 for 1st percentile) below which
weights will be capped at the threshold. Defaults to 0.01.}

\item{upper_quantile}{The upper quantile (e.g., 0.99 for 99th percentile) above which
weights will be capped at the threshold. Defaults to 0.99.}

\item{print_output}{A logical flag. If \code{TRUE}, the diagnostic report from
\code{svy_diagnostics()} is printed to the console using the full tibble print
(\code{n = Inf}). Defaults to \code{TRUE}.}

\item{...}{Additional arguments passed directly to \code{pewmethods::trim_weights}
(e.g., \code{minval}, \code{maxval}, \code{strict}).}
}
\value{
A \strong{numeric vector} containing the final trimmed weights (named \code{TRIM_WEIGHT}).
}
\description{
Implements weight trimming (Winsorization) to reduce the influence
of extreme weights, improving variance estimation and stability. This is a
wrapper around \code{pewmethods::trim_weights()}.
}
\details{
Trimming replaces weights falling outside the specified quantiles with the
quantile values themselves. This function requires \code{pewmethods} to be installed.
}
\examples{
# Requires devtools::load_all() and the pewmethods package installed
if (requireNamespace("pewmethods", quietly = TRUE) &&
    requireNamespace("dplyr", quietly = TRUE)) {

  # Load the internal data
  data("survey_df")

  # Trim the existing WEIGHT column at the 1st and 99th percentiles (default)
  trimmed_weights <- svy_trim(survey_df, "WEIGHT")

  # Check max original vs max trimmed
  # max(survey_df$WEIGHT)
  # max(trimmed_weights)
}

}
